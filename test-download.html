<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar Download Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-2xl font-bold mb-4">Calendar Download Test</h1>
        
        <div class="space-y-4">
            <button onclick="testLibraries()" class="w-full bg-blue-500 text-white p-3 rounded hover:bg-blue-600">
                Test Libraries
            </button>
            
            <button onclick="testPDF()" class="w-full bg-green-500 text-white p-3 rounded hover:bg-green-600">
                Test PDF Generation
            </button>
            
            <button onclick="testExcel()" class="w-full bg-yellow-500 text-white p-3 rounded hover:bg-yellow-600">
                Test Excel Generation
            </button>
        </div>
        
        <div id="results" class="mt-4 p-3 bg-gray-100 rounded text-sm"></div>
    </div>

    <!-- PDF/Excel Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <script>
        function log(message) {
            const results = document.getElementById('results');
            results.innerHTML += message + '<br>';
        }
        
        function testLibraries() {
            log('=== Testing Libraries ===');
            log('jsPDF available: ' + (typeof window.jspdf !== 'undefined'));
            log('XLSX available: ' + (typeof XLSX !== 'undefined'));
            
            if (window.jspdf) {
                log('jsPDF version: ' + window.jspdf.version);
            }
            if (XLSX) {
                log('XLSX version: ' + XLSX.version);
            }
        }
        
        function testPDF() {
            log('=== Testing PDF Generation ===');
            try {
                if (typeof window.jspdf === 'undefined') {
                    log('ERROR: jsPDF not loaded');
                    return;
                }
                
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF();
                
                doc.setFontSize(20);
                doc.text('Test Calendar', 20, 30);
                
                doc.setFontSize(12);
                doc.text('This is a test PDF generated by jsPDF', 20, 50);
                
                // Simple calendar grid
                for (let i = 0; i < 7; i++) {
                    for (let j = 0; j < 5; j++) {
                        doc.rect(20 + i * 20, 70 + j * 15, 20, 15);
                    }
                }
                
                doc.save('test-calendar.pdf');
                log('SUCCESS: PDF generated and downloaded');
                
            } catch (error) {
                log('ERROR: ' + error.message);
                console.error('PDF error:', error);
            }
        }
        
        function testExcel() {
            log('=== Testing Excel Generation ===');
            try {
                if (typeof XLSX === 'undefined') {
                    log('ERROR: XLSX not loaded');
                    return;
                }
                
                const data = [
                    ['Test Calendar'],
                    [],
                    ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
                    ['', '', '', '1', '2', '3', '4'],
                    ['5', '6', '7', '8', '9', '10', '11'],
                    ['12', '13', '14', '15', '16', '17', '18']
                ];
                
                const wb = XLSX.utils.book_new();
                const ws = XLSX.utils.aoa_to_sheet(data);
                XLSX.utils.book_append_sheet(wb, ws, 'Calendar');
                
                XLSX.writeFile(wb, 'test-calendar.xlsx');
                log('SUCCESS: Excel generated and downloaded');
                
            } catch (error) {
                log('ERROR: ' + error.message);
                console.error('Excel error:', error);
            }
        }
        
        // Test on page load
        window.addEventListener('load', function() {
            setTimeout(testLibraries, 1000);
        });
    </script>
</body>
</html>
